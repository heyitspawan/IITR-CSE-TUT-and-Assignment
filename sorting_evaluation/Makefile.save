CXX = g++
SRC = main.cpp
OUT = sort
ARGS = 10000

# Mapping algorithm names to numeric constants
MERGE = 1
QUICK = 2
RQUICK = 3
HEAP = 4
BUBBLE = 5
SELECTION = 6

ALGORITHMS = MERGE QUICK RQUICK HEAP BUBBLE SELECTION

.PHONY: all clean run

all: $(ALGORITHMS)

$(ALGORITHMS):
	$(CXX) -DALGO=$($@) $(SRC) -o $(OUT)_$@

# run: all
# 	@mkdir -p results
# 	@for algo in $(ALGORITHMS); do \
# 		for i in {1..5}; do \
# 			/usr/bin/env time -f "$$algo,%e,%M" ./sort_$$algo $(ARGS) 2>> results/raw.csv; \

# 		done; \

run:
	@mkdir -p results
	@echo "Algorithm,Time(s),Memory(KB)" > results/raw.csv
	@for algo in MERGE QUICK RQUICK HEAP BUBBLE SELECTION; do \
		./sort_$$algo $(ARGS) > /dev/null; \
		/usr/bin/env time -f "$$algo,%e,%M" ./sort_$$algo $(ARGS) 2>> results/raw.csv; \
	done
	done

clean:
	rm -f sort_* *.o
	rm -rf results
